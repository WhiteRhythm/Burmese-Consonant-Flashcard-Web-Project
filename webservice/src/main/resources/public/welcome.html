<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study - Burmese Consonants</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- IMPORTANT: 'Padauk' is required for Burmese text -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Padauk:wght@400;700&family=Playfair+Display:ital,wght@0,700;1,400&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        body { font-family: 'Lato', sans-serif; }
        
        /* Apply Padauk font specifically to Burmese text areas */
        .burmese-font { font-family: 'Padauk', sans-serif; }
        .serif-font { font-family: 'Playfair Display', serif; }

        .bg-pattern {
            background-color: #2b0202;
            background-image: linear-gradient(to bottom right, #4a0404, #1a0000);
        }

        /* 3D Card Flip CSS */
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .flipped { transform: rotateY(180deg); }

        .card-shadow {
            box-shadow: 0 0 40px rgba(251, 191, 36, 0.15);
        }
    </style>
</head>
<body class="bg-pattern min-h-screen flex flex-col text-white">

    <!-- Navbar -->
    <header class="flex items-center justify-between px-8 py-4 bg-black/30 backdrop-blur-md border-b border-white/10 sticky top-0 z-50">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-amber-500 flex items-center justify-center text-black font-bold font-serif">B</div>
            <span class="font-bold text-amber-500 tracking-wider hidden sm:block">Burmese Mastery</span>
        </div>
        <div class="flex items-center gap-4">
            <span class="text-sm text-gray-400">Scholar: <span id="userDisplay" class="text-white">...</span></span>
            <button onclick="logout()" class="text-gray-400 hover:text-red-400 transition-colors" title="Logout">
                <i class="ph-bold ph-sign-out text-xl"></i>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col items-center justify-center p-6 w-full max-w-4xl mx-auto">
        
        <div class="text-center mb-8">
            <h2 class="serif-font text-3xl md:text-4xl text-amber-100 italic">"The Golden Script"</h2>
            <p class="text-amber-500/60 mt-2 text-sm uppercase tracking-widest">Tap card to reveal meaning</p>
        </div>

        <!-- The Flashcard -->
        <div id="cardContainer" class="relative w-full max-w-sm aspect-[3/4] cursor-pointer perspective-1000 group mb-8" onclick="flipCard()">
            <div id="cardInner" class="relative w-full h-full transition-transform duration-700 transform-style-3d shadow-2xl rounded-2xl">
                
                <!-- Front (Burmese Character) -->
                <div class="absolute w-full h-full backface-hidden bg-gradient-to-br from-amber-50 to-amber-100 rounded-2xl flex flex-col items-center justify-center border-8 border-amber-600/20 card-shadow">
                    <div class="absolute top-4 left-4 w-full h-full border border-amber-900/10 rounded-xl pointer-events-none transform -translate-x-2 -translate-y-2"></div>
                    
                    <!-- The id="cardFront" is where the consonant appears -->
                    <h1 id="cardFront" class="burmese-font text-[10rem] text-red-900 leading-none drop-shadow-lg">...</h1>
                    
                    <div class="mt-8 text-amber-900/40 text-sm font-bold uppercase tracking-widest">Consonant</div>
                </div>

                <!-- Back (Definition) -->
                <div class="absolute w-full h-full backface-hidden rotate-y-180 bg-gradient-to-br from-gray-900 to-black rounded-2xl border-2 border-amber-500/50 flex flex-col items-center justify-center p-8 text-center card-shadow">
                    <i class="ph-fill ph-speaker-high text-amber-500 text-3xl mb-6 opacity-50"></i>
                    <h2 id="cardBack" class="text-4xl text-white font-bold mb-4 serif-font">...</h2>
                    <p class="text-gray-400 text-sm">Memorize the shape and sound.</p>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="flex gap-4 w-full max-w-sm">
            <button onclick="handleNext()" class="flex-1 bg-white/5 hover:bg-white/10 border border-white/10 text-gray-300 py-4 rounded-xl transition-all flex flex-col items-center gap-1 group">
                <i class="ph-bold ph-arrow-counter-clockwise text-xl group-hover:text-amber-400"></i>
                <span class="text-xs font-bold uppercase">Skip</span>
            </button>
            <button onclick="handleNext()" class="flex-[2] bg-amber-600 hover:bg-amber-500 text-white py-4 rounded-xl shadow-lg transition-all flex flex-col items-center gap-1">
                <i class="ph-bold ph-check text-xl"></i>
                <span class="text-xs font-bold uppercase">Next Card</span>
            </button>
        </div>

    </main>

    <script>
        const username = localStorage.getItem('username');
        if (!username) window.location.href = 'login.html';
        document.getElementById('userDisplay').textContent = username;

        let isFlipped = false;

        async function fetchCard() {
            try {
                // Fetch random card from Java server
                const res = await fetch('/flashcard');
                const data = await res.json();
                
                // Update text logic
                setTimeout(() => {
                    document.getElementById('cardFront').textContent = data.front;
                    document.getElementById('cardBack').textContent = data.back;
                }, isFlipped ? 300 : 0); 
                
            } catch (e) {
                console.error("Connection failed");
            }
        }

        function flipCard() {
            isFlipped = !isFlipped;
            const cardInner = document.getElementById('cardInner');
            if (isFlipped) {
                cardInner.classList.add('flipped');
            } else {
                cardInner.classList.remove('flipped');
            }
        }

        function handleNext() {
            const cardInner = document.getElementById('cardInner');
            if (isFlipped) {
                isFlipped = false;
                cardInner.classList.remove('flipped');
                setTimeout(fetchCard, 300);
            } else {
                fetchCard();
            }
        }

        function logout() {
            localStorage.removeItem('username');
            localStorage.removeItem('token');
            window.location.href = 'login.html';
        }

        // Initial Load
        fetchCard();
    </script>
</body>
</html>